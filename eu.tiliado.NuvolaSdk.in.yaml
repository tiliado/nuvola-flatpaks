build-runtime: true
id: "eu.tiliado.NuvolaSdk"
id-platform: "eu.tiliado.NuvolaPlatform"
branch: master
runtime: "org.gnome.Sdk"
runtime-version: "@GNOME_VERSION@"
sdk: org.gnome.Sdk

sdk-extensions:
  - "org.gnome.Sdk.Debug"
  - "org.gnome.Sdk.Locale"
  - "org.gnome.Sdk.Docs"
#platform-extensions:
# FIXME:  - "org.gnome.Platform.Locale"
inherit-extensions:
  - "org.freedesktop.Platform.GL"
  - "org.freedesktop.Platform.Timezones"
  - "org.freedesktop.Platform.GStreamer"
  - "org.freedesktop.Platform.Icontheme"
  - "org.freedesktop.Platform.VAAPI.Intel"
# FIXME:  - "org.freedesktop.Platform.html5-codecs"
  - "org.gtk.Gtk3theme"
inherit-sdk-extensions:
  - "org.freedesktop.Sdk.Extension"

modules:

  - name: greybird
    x-anitya-id: 1250
    x-version: "3.22.3"
    buildsystem: simple
    build-commands:
      - "install -dm755 /usr/share/themes/Greybird/gtk-3.0"
      - "cp -a gtk-3.0/*.css /usr/share/themes/Greybird/gtk-3.0"
      - "cp -aRL gtk-3.0/apps /usr/share/themes/Greybird/gtk-3.0"
      - "cp -aRL gtk-3.0/assets /usr/share/themes/Greybird/gtk-3.0"
    sources:
      - type: archive
        x-url-pattern: "https://github.com/shimmerproject/Greybird/archive/v{version}.tar.gz"
        url: https://github.com/shimmerproject/Greybird/archive/v3.22.3.tar.gz
        sha256: 7b81451f6157c49e4a8b01c4889668c3bc7653fc0a910e536a615705fbb5aec3

  - name: python3
    x-anitya-id: 13254
    x-version: "3.6.2"
    build-options:
      env:
        PYTHONHASHSEED: "0"
    ensure-writable:
      - "/bin/pip3"
    sources:
      - type: archive
        x-url-pattern: "https://www.python.org/ftp/python/{version}/Python-{version}.tar.xz"
        url: "https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tar.xz"
        sha256: "9229773be41ed144370f47f0f626a1579931f5a390f1e8e3853174d52edd64a9"
      - type: file
        path: "tools/fixpyc3timestamp.py"
    post-install: 
      - "cd /usr/bin && rm 2to3* idle3* pydoc3* pyvenv*"
      - "rm -r /usr/share/man /usr/lib/*.a"
      - "rm -r /usr/lib/python3.6/site-packages/pip /usr/lib/python3.6/test/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/setuptools/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/setuptools/command/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/pkg_resources/_vendor/packaging/__pycache__"
      - "rm -r /usr/lib/python3.6/unittest/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/pkg_resources/_vendor/__pycache__/"
      - "./fixpyc3timestamp.py /usr"

  - name: python3-pyparsing
    x-anitya-id: 3756
    x-version: "2.1.10"
    buildsystem: simple
    ensure-writable:
      - /lib/python3.6/site-packages/easy-install.pth
      - /lib/python3.6/site-packages/setuptools.pth
    build-commands:
      - /usr/bin/python3.6 setup.py install -v --prefix=/usr
    sources:
      - type: archive
        x-url-pattern: https://downloads.sourceforge.net/project/pyparsing/pyparsing/pyparsing-{version}/pyparsing-{version}.tar.gz
        url: https://downloads.sourceforge.net/project/pyparsing/pyparsing/pyparsing-2.1.10/pyparsing-2.1.10.tar.gz
        sha256: 811c3e7b0031021137fc83e051795025fcb98674d07eb8fe922ba4de53d39188
