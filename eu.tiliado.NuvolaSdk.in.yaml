build-runtime: true
id: "eu.tiliado.NuvolaSdk"
id-platform: "eu.tiliado.NuvolaPlatform"
branch: master
runtime: "org.gnome.Sdk"
runtime-version: "@GNOME_VERSION@"
sdk: org.gnome.Sdk

sdk-extensions:
  - "org.gnome.Sdk.Debug"
  - "org.gnome.Sdk.Locale"
  - "org.gnome.Sdk.Docs"
#platform-extensions:
# FIXME:  - "org.gnome.Platform.Locale"
inherit-extensions:
  - "org.freedesktop.Platform.GL"
  - "org.freedesktop.Platform.Timezones"
  - "org.freedesktop.Platform.GStreamer"
  - "org.freedesktop.Platform.Icontheme"
  - "org.freedesktop.Platform.VAAPI.Intel"
# FIXME:  - "org.freedesktop.Platform.html5-codecs"
  - "org.gtk.Gtk3theme"
inherit-sdk-extensions:
  - "org.freedesktop.Sdk.Extension"

modules:

  - name: python3
    x-anitya-id: 13254
    x-version: "3.6.2"
    build-options:
      env:
        PYTHONHASHSEED: "0"
    ensure-writable:
      - "/bin/pip3"
      
    sources:
      - type: archive
        x-url-pattern: "https://www.python.org/ftp/python/{version}/Python-{version}.tar.xz"
        url: "https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tar.xz"
        sha256: "9229773be41ed144370f47f0f626a1579931f5a390f1e8e3853174d52edd64a9"
      - type: file
        path: "tools/fixpyc3timestamp.py"
    post-install: 
      - "cd /usr/bin && rm 2to3* idle3* pydoc3* pyvenv*"
      - "rm -r /usr/share/man /usr/lib/*.a"
      - "rm -r /usr/lib/python3.6/site-packages/pip /usr/lib/python3.6/test/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/setuptools/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/setuptools/command/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/pkg_resources/_vendor/packaging/__pycache__"
      - "rm -r /usr/lib/python3.6/unittest/__pycache__"
      - "rm -r /usr/lib/python3.6/site-packages/pkg_resources/_vendor/__pycache__/"
      - "./fixpyc3timestamp.py /usr"
